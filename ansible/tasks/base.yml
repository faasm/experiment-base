---

- name: "System deps"
  become: yes
  apt:
    name:
      - apt-transport-https
      - ca-certificates
      - curl
      - gnupg2
      - pass
      - software-properties-common
      - linux-generic-hwe-20.04
    update_cache: yes

- name: "Create code dir"
  file:
    path: "/home/{{ ansible_ssh_user }}/code"
    state: directory

- name: "Clone faasm repo"
  git:
    repo: "https://www.github.com/faasm/faasm.git"
    dest: "/home/{{ ansible_ssh_user }}/code/faasm"
    depth: 1
    update: yes
    clone: yes
    force: yes

- name: "Clone experiments repo"
  git:
    repo: "https://github.com/faasm/experiment-base"
    dest: "/home/{{ ansible_ssh_user }}/code/experiment-base"
    depth: 1
    update: yes
    clone: yes
    force: yes
